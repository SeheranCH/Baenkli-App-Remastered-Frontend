{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\swesthauser\\\\Documents\\\\_D\\\\Workspace\\\\tbz\\\\Baenkli-App-Remastered-Frontend\\\\src\\\\components\\\\other\\\\context\\\\SessionHandlerContext.js\";\nimport React, { createContext, useState, useEffect } from \"react\";\nimport { useHistory } from 'react-router-dom';\nimport UserService from \"../../../service/UserService\";\nconst SessionHandlerContext = createContext();\nexport default SessionHandlerContext;\nexport const SessionHandlerContextProvider = props => {\n  const [user, setUser] = useState(JSON.parse(localStorage.getItem(\"user\")));\n  const history = useHistory();\n\n  const setActiveUser = user => {\n    localStorage.setItem(\"user\", JSON.stringify(user));\n    setUser(user); // AuthorityService.initAuthoritySet(user);\n  }; // const setActiveUserAvatar = (avatar) => {\n  //     setUser(user => ({...user, avatar}));\n  // };\n\n\n  const logout = () => {\n    // RoleService.clearRoles();\n    // AuthorityService.clearAuthorities();\n    localStorage.clear();\n    setUser(null);\n    history.push(\"/login\");\n  };\n\n  const login = data => {\n    UserService.login(data).then(res => {\n      console.log('Show user info ', res);\n      localStorage.setItem(\"token\", res.headers[\"authorization\"]);\n      let activeUser = res.data;\n      delete activeUser.password;\n      setActiveUser(activeUser);\n      history.push('/');\n    }).error(err => {\n      console.error('Error in SessionHandlerContext', err);\n    });\n  };\n\n  const loadActiveUser = () => {\n    setActiveUser(JSON.parse(localStorage.getItem('user')));\n  };\n\n  useEffect(() => {\n    loadActiveUser(); //eslint-disable-next-line\n  }, []);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(SessionHandlerContext.Provider, {\n    value: {\n      user,\n      setActiveUser,\n      login,\n      logout,\n      loadActiveUser\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 13\n    }\n  }, props.children));\n};","map":{"version":3,"sources":["C:/Users/swesthauser/Documents/_D/Workspace/tbz/Baenkli-App-Remastered-Frontend/src/components/other/context/SessionHandlerContext.js"],"names":["React","createContext","useState","useEffect","useHistory","UserService","SessionHandlerContext","SessionHandlerContextProvider","props","user","setUser","JSON","parse","localStorage","getItem","history","setActiveUser","setItem","stringify","logout","clear","push","login","data","then","res","console","log","headers","activeUser","password","error","err","loadActiveUser","children"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,aAAhB,EAA+BC,QAA/B,EAAyCC,SAAzC,QAA0D,OAA1D;AACA,SAASC,UAAT,QAA2B,kBAA3B;AACA,OAAOC,WAAP,MAAwB,8BAAxB;AAGA,MAAMC,qBAAqB,GAAGL,aAAa,EAA3C;AACA,eAAeK,qBAAf;AAGA,OAAO,MAAMC,6BAA6B,GAAIC,KAAD,IAAW;AAEpD,QAAM,CAACC,IAAD,EAAOC,OAAP,IAAkBR,QAAQ,CAACS,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAX,CAAD,CAAhC;AACA,QAAMC,OAAO,GAAGX,UAAU,EAA1B;;AAEA,QAAMY,aAAa,GAAIP,IAAD,IAAU;AAC5BI,IAAAA,YAAY,CAACI,OAAb,CAAqB,MAArB,EAA6BN,IAAI,CAACO,SAAL,CAAeT,IAAf,CAA7B;AACAC,IAAAA,OAAO,CAACD,IAAD,CAAP,CAF4B,CAG5B;AACH,GAJD,CALoD,CAWpD;AACA;AACA;;;AAEA,QAAMU,MAAM,GAAG,MAAM;AACjB;AACA;AACAN,IAAAA,YAAY,CAACO,KAAb;AACAV,IAAAA,OAAO,CAAC,IAAD,CAAP;AACAK,IAAAA,OAAO,CAACM,IAAR,CAAa,QAAb;AACH,GAND;;AAQA,QAAMC,KAAK,GAAIC,IAAD,IAAU;AACnBlB,IAAAA,WAAW,CAACiB,KAAZ,CAAkBC,IAAlB,EACMC,IADN,CACWC,GAAG,IAAI;AACXC,MAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ,EAA+BF,GAA/B;AACAZ,MAAAA,YAAY,CAACI,OAAb,CAAqB,OAArB,EAA8BQ,GAAG,CAACG,OAAJ,CAAY,eAAZ,CAA9B;AACA,UAAIC,UAAU,GAAGJ,GAAG,CAACF,IAArB;AACA,aAAOM,UAAU,CAACC,QAAlB;AACAd,MAAAA,aAAa,CAACa,UAAD,CAAb;AACAd,MAAAA,OAAO,CAACM,IAAR,CAAa,GAAb;AACD,KARN,EASMU,KATN,CASYC,GAAG,IAAI;AACVN,MAAAA,OAAO,CAACK,KAAR,CAAc,gCAAd,EAAgDC,GAAhD;AACH,KAXN;AAYJ,GAbD;;AAeA,QAAMC,cAAc,GAAG,MAAM;AACzBjB,IAAAA,aAAa,CAACL,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAX,CAAD,CAAb;AACH,GAFD;;AAIAX,EAAAA,SAAS,CAAC,MAAM;AACZ8B,IAAAA,cAAc,GADF,CAEZ;AACH,GAHQ,EAGN,EAHM,CAAT;AAKA,sBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACI,oBAAC,qBAAD,CAAuB,QAAvB;AACI,IAAA,KAAK,EAAE;AACHxB,MAAAA,IADG;AAEHO,MAAAA,aAFG;AAGHM,MAAAA,KAHG;AAIHH,MAAAA,MAJG;AAKHc,MAAAA;AALG,KADX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KASKzB,KAAK,CAAC0B,QATX,CADJ,CADJ;AAeH,CA9DM","sourcesContent":["import React, { createContext, useState, useEffect } from \"react\";\r\nimport { useHistory } from 'react-router-dom'\r\nimport UserService from \"../../../service/UserService\";\r\n\r\n\r\nconst SessionHandlerContext = createContext();\r\nexport default SessionHandlerContext;\r\n\r\n\r\nexport const SessionHandlerContextProvider = (props) => {\r\n    \r\n    const [user, setUser] = useState(JSON.parse(localStorage.getItem(\"user\")));\r\n    const history = useHistory();\r\n\r\n    const setActiveUser = (user) => { \r\n        localStorage.setItem(\"user\", JSON.stringify(user));\r\n        setUser(user);\r\n        // AuthorityService.initAuthoritySet(user);\r\n    };\r\n\r\n    // const setActiveUserAvatar = (avatar) => {\r\n    //     setUser(user => ({...user, avatar}));\r\n    // };\r\n\r\n    const logout = () => {\r\n        // RoleService.clearRoles();\r\n        // AuthorityService.clearAuthorities();\r\n        localStorage.clear();\r\n        setUser(null)\r\n        history.push(\"/login\");\r\n    };\r\n\r\n    const login = (data) => {\r\n         UserService.login(data)\r\n              .then(res => {\r\n                console.log('Show user info ', res);\r\n                localStorage.setItem(\"token\", res.headers[\"authorization\"])\r\n                let activeUser = res.data;\r\n                delete activeUser.password;\r\n                setActiveUser(activeUser)\r\n                history.push('/');\r\n              })\r\n              .error(err => {\r\n                  console.error('Error in SessionHandlerContext', err);\r\n              });\r\n    }\r\n\r\n    const loadActiveUser = () => {\r\n        setActiveUser(JSON.parse(localStorage.getItem('user')));\r\n    };\r\n\r\n    useEffect(() => {\r\n        loadActiveUser();\r\n        //eslint-disable-next-line\r\n    }, []);\r\n\r\n    return (\r\n        <div>\r\n            <SessionHandlerContext.Provider\r\n                value={{\r\n                    user,\r\n                    setActiveUser,\r\n                    login,\r\n                    logout,\r\n                    loadActiveUser\r\n                }}\r\n            >\r\n                {props.children}\r\n            </SessionHandlerContext.Provider>\r\n        </div>\r\n    );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}